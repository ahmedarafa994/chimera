<?xml version="1.0" encoding="UTF-8"?>
<story-context>
  <meta>
    <story-id>1.3</story-id>
    <epic>Epic 1: Multi-Provider Foundation</epic>
    <title>Health Monitoring</title>
    <status>Done</status>
    <complexity>Medium</complexity>
    <business-priority>High</business-priority>
  </meta>

  <technical-context>
    <implementation-status>Complete - Existing Implementation</implementation-status>
    <architecture-pattern>Multi-tier Health Check System</architecture-pattern>
    <integration-points>
      <point>Provider availability monitoring</point>
      <point>Circuit breaker state tracking</point>
      <point>Database and Redis connectivity</point>
      <point>External service dependency checks</point>
    </integration-points>
  </technical-context>

  <business-context>
    <value-proposition>Comprehensive system health visibility and proactive issue detection</value-proposition>
    <user-impact>99.9% system reliability with early warning on potential issues</user-impact>
    <risk-mitigation>
      <risk>Service degradation</risk>
      <mitigation>Real-time health monitoring with automated alerting</mitigation>
    </risk-mitigation>
  </business-context>

  <implementation-details>
    <core-files>
      <file path="backend-api/app/api/v1/endpoints/health.py" role="Health check endpoints with tier-based monitoring"/>
      <file path="backend-api/app/services/health_service.py" role="Comprehensive health check orchestration"/>
      <file path="backend-api/app/core/health_checks.py" role="Individual health check implementations"/>
    </core-files>

    <health-endpoints>
      <endpoint path="/health" type="Basic liveness check" response_time="&lt;50ms"/>
      <endpoint path="/health/ready" type="Readiness probe with dependencies" response_time="&lt;200ms"/>
      <endpoint path="/health/full" type="Comprehensive system health" response_time="&lt;500ms"/>
      <endpoint path="/health/integration" type="Service dependency graph" response_time="&lt;300ms"/>
    </health-endpoints>

    <key-features>
      <feature>Tier-based Monitoring: Basic, Ready, Full, Integration levels</feature>
      <feature>Provider Health: Individual LLM provider availability checks</feature>
      <feature>Circuit Breaker Status: Real-time circuit state monitoring</feature>
      <feature>Database Connectivity: PostgreSQL and Redis health checks</feature>
      <feature>Service Dependencies: External service availability tracking</feature>
      <feature>Performance Metrics: Response time and throughput monitoring</feature>
    </key-features>

    <monitoring-metrics>
      <metric name="Provider Availability">Real-time status of all configured LLM providers</metric>
      <metric name="Circuit Breaker States">Open/Closed/Half-Open status per provider</metric>
      <metric name="Database Health">Connection pool status and query performance</metric>
      <metric name="Service Dependencies">External API availability and latency</metric>
    </monitoring-metrics>
  </implementation-details>

  <acceptance-criteria-mapping>
    <criterion id="1">Basic health endpoint ✓ - /health liveness check</criterion>
    <criterion id="2">Readiness check ✓ - /health/ready with dependencies</criterion>
    <criterion id="3">Provider monitoring ✓ - Individual provider health status</criterion>
    <criterion id="4">Circuit breaker integration ✓ - Real-time state tracking</criterion>
    <criterion id="5">Database connectivity ✓ - PostgreSQL and Redis checks</criterion>
    <criterion id="6">Service dependencies ✓ - External service monitoring</criterion>
    <criterion id="7">Performance metrics ✓ - Response time and throughput</criterion>
    <criterion id="8">Integration graph ✓ - Service dependency visualization</criterion>
  </acceptance-criteria-mapping>

  <dependencies>
    <upstream>
      <dependency>Story 1.1: Provider Configuration Management</dependency>
      <dependency>Story 1.2: Circuit Breaker Implementation</dependency>
    </upstream>
    <downstream>
      <dependency>Story 1.4: API Security Framework</dependency>
      <dependency>Monitoring and observability stories</dependency>
    </downstream>
  </dependencies>

  <testing-coverage>
    <unit-tests>Individual health check functions, endpoint response validation</unit-tests>
    <integration-tests>End-to-end health monitoring, dependency failure scenarios</integration-tests>
    <performance-tests>Health endpoint response time under load</performance-tests>
  </testing-coverage>
</story-context>