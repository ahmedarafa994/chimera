<!DOCTYPE html>
<html>
<head>
    <title>Chimera Performance Monitor</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .metric-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 10px 0; }
        .metric-title { font-weight: bold; color: #333; }
        .metric-value { font-size: 24px; margin: 10px 0; }
        .status-good { color: #4CAF50; }
        .status-warning { color: #FF9800; }
        .status-critical { color: #F44336; }
        .alerts-section { background-color: #f5f5f5; padding: 15px; border-radius: 8px; }
    </style>
    <script>
        async function loadMetrics() {
            try {
                const response = await fetch('/profiling/metrics');
                const data = await response.json();

                document.getElementById('cpu-usage').textContent =
                    data.system_metrics.cpu_usage ? data.system_metrics.cpu_usage.toFixed(1) + '%' : 'N/A';

                document.getElementById('memory-usage').textContent =
                    data.system_metrics.memory_usage ? data.system_metrics.memory_usage.toFixed(1) + '%' : 'N/A';

                document.getElementById('api-response').textContent =
                    data.system_metrics.api_response_time ? data.system_metrics.api_response_time.toFixed(0) + 'ms' : 'N/A';

                document.getElementById('active-alerts').textContent = data.alerts.total_active_alerts || 0;

                // Update status indicators
                updateStatus('cpu-status', data.system_metrics.cpu_usage, 70, 85);
                updateStatus('memory-status', data.system_metrics.memory_usage, 80, 90);
                updateStatus('api-status', data.system_metrics.api_response_time, 1000, 3000);

            } catch (error) {
                console.error('Failed to load metrics:', error);
            }
        }

        function updateStatus(elementId, value, warning, critical) {
            const element = document.getElementById(elementId);
            if (!value) {
                element.className = '';
                return;
            }

            if (value >= critical) {
                element.className = 'status-critical';
            } else if (value >= warning) {
                element.className = 'status-warning';
            } else {
                element.className = 'status-good';
            }
        }

        // Load metrics every 30 seconds
        setInterval(loadMetrics, 30000);

        // Load on page load
        window.onload = loadMetrics;
    </script>
</head>
<body>
    <h1>Chimera Performance Monitor</h1>

    <div class="metric-card">
        <div class="metric-title">CPU Usage</div>
        <div class="metric-value" id="cpu-usage">Loading...</div>
        <div id="cpu-status"></div>
    </div>

    <div class="metric-card">
        <div class="metric-title">Memory Usage</div>
        <div class="metric-value" id="memory-usage">Loading...</div>
        <div id="memory-status"></div>
    </div>

    <div class="metric-card">
        <div class="metric-title">API Response Time</div>
        <div class="metric-value" id="api-response">Loading...</div>
        <div id="api-status"></div>
    </div>

    <div class="alerts-section">
        <h2>Active Alerts</h2>
        <div class="metric-value" id="active-alerts">Loading...</div>
        <p><a href="/profiling/alerts">View All Alerts</a></p>
    </div>

    <div style="margin-top: 30px;">
        <h2>Performance Reports</h2>
        <ul>
            <li><a href="/profiling/reports/cpu">CPU Profiling Report</a></li>
            <li><a href="/profiling/reports/memory">Memory Analysis Report</a></li>
            <li><a href="/profiling/reports/database">Database Performance Report</a></li>
            <li><a href="/profiling/reports/baseline">Baseline Test Results</a></li>
        </ul>
    </div>

    <div style="margin-top: 30px;">
        <h2>System Controls</h2>
        <button onclick="fetch('/profiling/start', {method: 'POST'}).then(() => alert('Monitoring started'))">
            Start Monitoring
        </button>
        <button onclick="fetch('/profiling/stop', {method: 'POST'}).then(() => alert('Monitoring stopped'))">
            Stop Monitoring
        </button>
    </div>

    <div style="margin-top: 30px; font-size: 12px; color: #666;">
        <p>Last updated: <span id="last-update"></span></p>
        <script>
            document.getElementById('last-update').textContent = new Date().toLocaleString();
        </script>
    </div>
</body>
</html>